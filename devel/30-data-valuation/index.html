
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://appliedai-initiative.github.io/pyDVL/devel/30-data-valuation/">
      
      
        <link rel="prev" href="../20-install/">
      
      
        <link rel="next" href="../40-influence/">
      
      <link rel="icon" href="../assets/signet.svg">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.20">
    
    
      
        <title>Computing Data Values - pyDVL</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/extra.css">
    
      <link rel="stylesheet" href="../css/neoteroi.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#computing-data-values" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
<div class="announcement">
    <aside class="announcement-content">
        pyDVL is in an early stage of development. Expect changes to functionality and the API until version 1.0.0.
    </aside>
</div>

          </div>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pyDVL" class="md-header__button md-logo" aria-label="pyDVL" data-md-component="logo">
      
  <img src="../assets/signet.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyDVL
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Computing Data Values
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/appliedAI-Initiative/pyDVL" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pyDVL" class="md-nav__button md-logo" aria-label="pyDVL" data-md-component="logo">
      
  <img src="../assets/signet.svg" alt="logo">

    </a>
    pyDVL
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/appliedAI-Initiative/pyDVL" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        pyDVL documentation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../10-getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../20-install/" class="md-nav__link">
        Installing pyDVL
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Computing Data Values
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Computing Data Values
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-dataset" class="md-nav__link">
    Creating a Dataset
  </a>
  
    <nav class="md-nav" aria-label="Creating a Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grouping-data" class="md-nav__link">
    Grouping data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-utility" class="md-nav__link">
    Creating a Utility
  </a>
  
    <nav class="md-nav" aria-label="Creating a Utility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-custom-scorers" class="md-nav__link">
    Using custom scorers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-the-utility" class="md-nav__link">
    Learning the utility
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leave-one-out-values" class="md-nav__link">
    Leave-One-Out values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shapley-values" class="md-nav__link">
    Shapley values
  </a>
  
    <nav class="md-nav" aria-label="Shapley values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combinatorial-shapley" class="md-nav__link">
    Combinatorial Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monte-carlo-combinatorial-shapley" class="md-nav__link">
    Monte Carlo Combinatorial Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owen-sampling" class="md-nav__link">
    Owen sampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permutation-shapley" class="md-nav__link">
    Permutation Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exact-shapley-for-knn" class="md-nav__link">
    Exact Shapley for KNN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-testing" class="md-nav__link">
    Group testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-values" class="md-nav__link">
    Core values
  </a>
  
    <nav class="md-nav" aria-label="Core values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#least-core-values" class="md-nav__link">
    Least Core values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exact-least-core" class="md-nav__link">
    Exact Least Core
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monte-carlo-least-core" class="md-nav__link">
    Monte Carlo Least Core
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#semi-values" class="md-nav__link">
    Semi-values
  </a>
  
    <nav class="md-nav" aria-label="Semi-values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beta-shapley" class="md-nav__link">
    Beta Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#banzhaf-indices" class="md-nav__link">
    Banzhaf indices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems-of-data-values" class="md-nav__link">
    Problems of data values
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../40-influence/" class="md-nav__link">
        Computing Influence Values
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../CHANGELOG/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          Code reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Code reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/">pydvl</a>
          
            <label for="__nav_7_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          pydvl
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_1" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/influence/">influence</a>
          
            <label for="__nav_7_1_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_1">
          <span class="md-nav__icon md-icon"></span>
          influence
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/influence/general/" class="md-nav__link">
        general
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/influence/inversion/" class="md-nav__link">
        inversion
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_1_3" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/influence/torch/">torch</a>
          
            <label for="__nav_7_1_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_1_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_1_3">
          <span class="md-nav__icon md-icon"></span>
          torch
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/influence/torch/functional/" class="md-nav__link">
        functional
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/influence/torch/torch_differentiable/" class="md-nav__link">
        torch_differentiable
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/influence/torch/util/" class="md-nav__link">
        util
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/influence/twice_differentiable/" class="md-nav__link">
        twice_differentiable
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_2" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/reporting/">reporting</a>
          
            <label for="__nav_7_1_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_2">
          <span class="md-nav__icon md-icon"></span>
          reporting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/reporting/plots/" class="md-nav__link">
        plots
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/reporting/scores/" class="md-nav__link">
        scores
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_3" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/utils/">utils</a>
          
            <label for="__nav_7_1_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_3">
          <span class="md-nav__icon md-icon"></span>
          utils
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/caching/" class="md-nav__link">
        caching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/config/" class="md-nav__link">
        config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/dataset/" class="md-nav__link">
        dataset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/numeric/" class="md-nav__link">
        numeric
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_3_5" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/utils/parallel/">parallel</a>
          
            <label for="__nav_7_1_3_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_1_3_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_3_5">
          <span class="md-nav__icon md-icon"></span>
          parallel
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/parallel/backend/" class="md-nav__link">
        backend
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_3_5_2" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/utils/parallel/futures/">futures</a>
          
            <label for="__nav_7_1_3_5_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_7_1_3_5_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_3_5_2">
          <span class="md-nav__icon md-icon"></span>
          futures
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/parallel/futures/ray/" class="md-nav__link">
        ray
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/parallel/map_reduce/" class="md-nav__link">
        map_reduce
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/progress/" class="md-nav__link">
        progress
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/score/" class="md-nav__link">
        score
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/status/" class="md-nav__link">
        status
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/types/" class="md-nav__link">
        types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/utils/utility/" class="md-nav__link">
        utility
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_4" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/value/">value</a>
          
            <label for="__nav_7_1_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_7_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_4">
          <span class="md-nav__icon md-icon"></span>
          value
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_4_1" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/value/least_core/">least_core</a>
          
            <label for="__nav_7_1_4_1">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_1_4_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_4_1">
          <span class="md-nav__icon md-icon"></span>
          least_core
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/least_core/common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/least_core/montecarlo/" class="md-nav__link">
        montecarlo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/least_core/naive/" class="md-nav__link">
        naive
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_4_2" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/value/loo/">loo</a>
          
            <label for="__nav_7_1_4_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_1_4_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_4_2">
          <span class="md-nav__icon md-icon"></span>
          loo
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/loo/naive/" class="md-nav__link">
        naive
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/result/" class="md-nav__link">
        result
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/sampler/" class="md-nav__link">
        sampler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/semivalues/" class="md-nav__link">
        semivalues
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_1_4_6" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../code-reference/pydvl/value/shapley/">shapley</a>
          
            <label for="__nav_7_1_4_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_7_1_4_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7_1_4_6">
          <span class="md-nav__icon md-icon"></span>
          shapley
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/common/" class="md-nav__link">
        common
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/gt/" class="md-nav__link">
        gt
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/knn/" class="md-nav__link">
        knn
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/montecarlo/" class="md-nav__link">
        montecarlo
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/naive/" class="md-nav__link">
        naive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/owen/" class="md-nav__link">
        owen
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/truncated/" class="md-nav__link">
        truncated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/shapley/types/" class="md-nav__link">
        types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-reference/pydvl/value/stopping/" class="md-nav__link">
        stopping
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../examples/">Examples</a>
          
            <label for="__nav_8">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/influence_imagenet/" class="md-nav__link">
        Influence functions for neural networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/influence_synthetic/" class="md-nav__link">
        Influence functions for data mislabeling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/influence_wine/" class="md-nav__link">
        Influence functions for outlier detection
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/least_core_basic/" class="md-nav__link">
        Least Core for Data Valuation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/shapley_basic_spotify/" class="md-nav__link">
        Shapley for data valuation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/shapley_knn_flowers/" class="md-nav__link">
        KNN Shapley
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../examples/shapley_utility_learning/" class="md-nav__link">
        Data Utility Learning
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-dataset" class="md-nav__link">
    Creating a Dataset
  </a>
  
    <nav class="md-nav" aria-label="Creating a Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#grouping-data" class="md-nav__link">
    Grouping data
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-utility" class="md-nav__link">
    Creating a Utility
  </a>
  
    <nav class="md-nav" aria-label="Creating a Utility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-custom-scorers" class="md-nav__link">
    Using custom scorers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#learning-the-utility" class="md-nav__link">
    Learning the utility
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#leave-one-out-values" class="md-nav__link">
    Leave-One-Out values
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#shapley-values" class="md-nav__link">
    Shapley values
  </a>
  
    <nav class="md-nav" aria-label="Shapley values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#combinatorial-shapley" class="md-nav__link">
    Combinatorial Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monte-carlo-combinatorial-shapley" class="md-nav__link">
    Monte Carlo Combinatorial Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#owen-sampling" class="md-nav__link">
    Owen sampling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permutation-shapley" class="md-nav__link">
    Permutation Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exact-shapley-for-knn" class="md-nav__link">
    Exact Shapley for KNN
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-testing" class="md-nav__link">
    Group testing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-values" class="md-nav__link">
    Core values
  </a>
  
    <nav class="md-nav" aria-label="Core values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#least-core-values" class="md-nav__link">
    Least Core values
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exact-least-core" class="md-nav__link">
    Exact Least Core
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monte-carlo-least-core" class="md-nav__link">
    Monte Carlo Least Core
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#semi-values" class="md-nav__link">
    Semi-values
  </a>
  
    <nav class="md-nav" aria-label="Semi-values">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#beta-shapley" class="md-nav__link">
    Beta Shapley
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#banzhaf-indices" class="md-nav__link">
    Banzhaf indices
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#problems-of-data-values" class="md-nav__link">
    Problems of data values
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="computing-data-values">Computing Data Values<a class="headerlink" href="#computing-data-values" title="Permanent link">&para;</a></h1>
<p><strong>Data valuation</strong> is the task of assigning a number to each element of a
training set which reflects its contribution to the final performance of a
model trained on it. This value is not an intrinsic property of the element of
interest, but a function of three factors:</p>
<ol>
<li>
<p>The dataset <span class="arithmatex">\(D\)</span>, or more generally, the distribution it was sampled
   from (with this we mean that <em>value</em> would ideally be the (expected)
   contribution of a data point to any random set <span class="arithmatex">\(D\)</span> sampled from the same
   distribution).</p>
</li>
<li>
<p>The algorithm <span class="arithmatex">\(\mathcal{A}\)</span> mapping the data <span class="arithmatex">\(D\)</span> to some estimator <span class="arithmatex">\(f\)</span>
   in a model class <span class="arithmatex">\(\mathcal{F}\)</span>. E.g. MSE minimization to find the parameters
   of a linear model.</p>
</li>
<li>
<p>The performance metric of interest <span class="arithmatex">\(u\)</span> for the problem. E.g. the <span class="arithmatex">\(R^2\)</span>
   score or the negative MSE over a test set.</p>
</li>
</ol>
<p>pyDVL collects algorithms for the computation of data values in this sense,
mostly those derived from cooperative game theory. The methods can be found in
the package <a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/#pydvl.value">pydvl.value</a> , with support from modules
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/dataset/#pydvl.utils.dataset">pydvl.utils.dataset</a>
and <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/utility/#pydvl.utils.utility">pydvl.utils.utility</a>, as detailed below.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Be sure to read the section on
<a class="autorefs autorefs-internal" href="#problems-of-data-values">the difficulties using data values</a>.</p>
</div>
<h2 id="creating-a-dataset">Creating a Dataset<a class="headerlink" href="#creating-a-dataset" title="Permanent link">&para;</a></h2>
<p>The first item in the tuple <span class="arithmatex">\((D, \mathcal{A}, u)\)</span> characterising data value is
the dataset. The class <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/dataset/#pydvl.utils.dataset.Dataset">Dataset</a> is a simple
convenience wrapper for the train and test splits that is used throughout pyDVL.
The test set will be used to evaluate a scoring function for the model.</p>
<p>It can be used as follows:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">from</span> <span class="nn">pydvl.utils</span> <span class="kn">import</span> <span class="n">Dataset</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>  <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">16</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="p">)</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</span></code></pre></div>
<p>It is also possible to construct Datasets from sklearn toy datasets for
illustrative purposes using <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/dataset/#pydvl.utils.dataset.Dataset.from_sklearn">from_sklearn</a>.</p>
<h3 id="grouping-data">Grouping data<a class="headerlink" href="#grouping-data" title="Permanent link">&para;</a></h3>
<p>Be it because data valuation methods are computationally very expensive, or
because we are interested in the groups themselves, it can be often useful or
necessary to group samples to valuate them together.
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/dataset/#pydvl.utils.dataset.GroupedDataset">GroupedDataset</a> provides an alternative to
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/dataset/#pydvl.utils.dataset.Dataset">Dataset</a> with the same interface which allows this.</p>
<p>You can see an example in action in the
<a href="../examples/shapley_basic_spotify">Spotify notebook</a>, but here's a simple
example grouping a pre-existing <code>Dataset</code>. First we construct an array mapping
each index in the dataset to a group, then use
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/dataset/#pydvl.utils.dataset.GroupedDataset.from_dataset">from_dataset</a>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">pydvl.utils</span> <span class="kn">import</span> <span class="n">GroupedDataset</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># Randomly assign elements to any one of num_groups:</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">data_groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_groups</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">))</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">grouped_dataset</span> <span class="o">=</span> <span class="n">GroupedDataset</span><span class="o">.</span><span class="n">from_dataset</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">data_groups</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="creating-a-utility">Creating a Utility<a class="headerlink" href="#creating-a-utility" title="Permanent link">&para;</a></h2>
<p>In pyDVL we have slightly overloaded the name "utility" and use it to refer to
an object that keeps track of all three items in <span class="arithmatex">\((D, \mathcal{A}, u)\)</span>. This
will be an instance of <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/utility/#pydvl.utils.utility.Utility">Utility</a> which, as mentioned,
is a convenient wrapper for the dataset, model and scoring function used for
valuation methods.</p>
<p>Here's a minimal example:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">sklearn</span> <span class="k">as</span> <span class="nn">sk</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="kn">from</span> <span class="nn">pydvl.utils</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Utility</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_sklearn</span><span class="p">(</span><span class="n">sk</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">())</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">model</span> <span class="o">=</span> <span class="n">sk</span><span class="o">.</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">()</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">utility</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</span></code></pre></div>
<p>The object <code>utility</code> is a callable that data valuation methods will execute
with different subsets of training data. Each call will retrain the model on a
subset and evaluate it on the test data using a scoring function. By default,
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/utility/#pydvl.utils.utility.Utility">Utility</a> will use <code>model.score()</code>, but it is
possible to use any scoring function (greater values must be better). In
particular, the constructor accepts the same types as argument as sklearn's
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_validate.html&gt;">cross_validate</a>:
a string, a scorer callable or <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/constants.html#None">None</a> for the default.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">utility</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;explained_variance&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p><code>Utility</code> will wrap the <code>fit()</code> method of the model to cache its results. This
greatly reduces computation times of Monte Carlo methods. Because of how caching
is implemented, it is important not to reuse <code>Utility</code> objects for different
datasets. You can read more about <a class="autorefs autorefs-internal" href="../20-install/#setting-up-the-cache">setting up the cache</a>
in the installation guide and the documentation
of the <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/caching/#pydvl.utils.caching">caching</a> module.</p>
<h3 id="using-custom-scorers">Using custom scorers<a class="headerlink" href="#using-custom-scorers" title="Permanent link">&para;</a></h3>
<p>The <code>scoring</code> argument of <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/utility/#pydvl.utils.utility.Utility">Utility</a> can be used to
specify a custom <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/score/#pydvl.utils.score.Scorer">Scorer</a> object. This is a simple
wrapper for a callable that takes a model, and test data and returns a score.</p>
<p>More importantly, the object provides information about the range of the score,
which is used by some methods by estimate the number of samples necessary, and
about what default value to use when the model fails to train.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The most important property of a <code>Scorer</code> is its default value. Because many
models will fail to fit on small subsets of the data, it is important to
provide a sensible default value for the score.</p>
</div>
<p>It is possible to skip the construction of the <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/score/#pydvl.utils.score.Scorer">Scorer</a>
when constructing the <code>Utility</code> object. The two following calls are equivalent:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">utility</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">(</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>   <span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="s2">&quot;explained_variance&quot;</span><span class="p">,</span> <span class="n">score_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">default_score</span><span class="o">=</span><span class="mf">0.0</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="n">utility</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">(</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>   <span class="n">model</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">Scorer</span><span class="p">(</span><span class="s2">&quot;explained_variance&quot;</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="learning-the-utility">Learning the utility<a class="headerlink" href="#learning-the-utility" title="Permanent link">&para;</a></h3>
<p>Because each evaluation of the utility entails a full retrain of the model with
a new subset of the training set, it is natural to try to learn this mapping
from subsets to scores. This is the idea behind <strong>Data Utility Learning (DUL)</strong>
 (Wang et al., 2022)<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> and in pyDVL it's as simple as wrapping the
<code>Utility</code> inside <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/utility/#pydvl.utils.utility.DataUtilityLearning">DataUtilityLearning</a>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">from</span> <span class="nn">pydvl.utils</span> <span class="kn">import</span> <span class="n">Utility</span><span class="p">,</span> <span class="n">DataUtilityLearning</span><span class="p">,</span> <span class="n">Dataset</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">LogisticRegression</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">dataset</span> <span class="o">=</span> <span class="n">Dataset</span><span class="o">.</span><span class="n">from_sklearn</span><span class="p">(</span><span class="n">load_iris</span><span class="p">())</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">u</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">(</span><span class="n">LogisticRegression</span><span class="p">(),</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">enable_cache</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="n">training_budget</span> <span class="o">=</span> <span class="mi">3</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="n">wrapped_u</span> <span class="o">=</span> <span class="n">DataUtilityLearning</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">training_budget</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="c1"># First 3 calls will be computed normally</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">training_budget</span><span class="p">):</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>   <span class="n">_</span> <span class="o">=</span> <span class="n">wrapped_u</span><span class="p">((</span><span class="n">i</span><span class="p">,))</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="c1"># Subsequent calls will be computed using the fit model for DUL</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="n">wrapped_u</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span></code></pre></div>
<p>As you can see, all that is required is a model to learn the utility itself and
the fitting and using of the learned model happens behind the scenes.</p>
<p>There is a longer example with an investigation of the results achieved by DUL
in <a href="../examples/shapley_utility_learning">a dedicated notebook</a>.</p>
<h2 id="leave-one-out-values">Leave-One-Out values<a class="headerlink" href="#leave-one-out-values" title="Permanent link">&para;</a></h2>
<p>The Leave-One-Out method is a simple approach that assigns each sample its
<em>marginal utility</em> as value:</p>
<div class="arithmatex">\[v_u(x_i) = u(D) − u(D \setminus \{x_i\}).\]</div>
<p>For the purposes of data valuation, this is rarely useful beyond serving as a
baseline for benchmarking. One particular weakness is that it does not
necessarily correlate with an intrinsic value of a sample: since it is a
marginal utility, it is affected by the "law" of diminishing returns. Often, the
training set is large enough for a single sample not to have any significant
effect on training performance, despite any qualities it may possess. Whether
this is indicative of low value or not depends on each one's goals and
definitions, but other methods are typically preferable.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">from</span> <span class="nn">pydvl.value.loo.naive</span> <span class="kn">import</span> <span class="n">naive_loo</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">naive_loo</span><span class="p">(</span><span class="n">utility</span><span class="p">)</span>
</span></code></pre></div>
<p>The return value of all valuation functions is an object of type
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/result/#pydvl.value.result.ValuationResult">ValuationResult</a>. This can be iterated over,
indexed with integers, slices and Iterables, as well as converted to a
<a class="autorefs autorefs-external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame">pandas.DataFrame</a>.</p>
<h2 id="shapley-values">Shapley values<a class="headerlink" href="#shapley-values" title="Permanent link">&para;</a></h2>
<p>The Shapley method is an approach to compute data values originating in
cooperative game theory. Shapley values are a common way of assigning payoffs to
each participant in a cooperative game (i.e. one in which players can form
coalitions) in a way that ensures that certain axioms are fulfilled.</p>
<p>pyDVL implements several methods for the computation and approximation of
Shapley values. They can all be accessed via the facade function
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/shapley/common/#pydvl.value.shapley.common.compute_shapley_values">compute_shapley_values</a>.
The supported methods are enumerated in
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/shapley/types/#pydvl.value.shapley.types.ShapleyMode">ShapleyMode</a>.</p>
<h3 id="combinatorial-shapley">Combinatorial Shapley<a class="headerlink" href="#combinatorial-shapley" title="Permanent link">&para;</a></h3>
<p>The first algorithm is just a verbatim implementation of the definition. As such
it returns as exact a value as the utility function allows (see what this means
in Problems of Data Values][problems-of-data-values]).</p>
<p>The value <span class="arithmatex">\(v\)</span> of the <span class="arithmatex">\(i\)</span>-th sample in dataset <span class="arithmatex">\(D\)</span> wrt. utility <span class="arithmatex">\(u\)</span> is computed
as a weighted sum of its marginal utility wrt. every possible coalition of
training samples within the training set:</p>
<div class="arithmatex">\[
v_u(x_i) = \frac{1}{n} \sum_{S \subseteq D \setminus \{x_i\}}
\binom{n-1}{ | S | }^{-1} [u(S \cup \{x_i\}) − u(S)]
,\]</div>
<div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_shapley_values</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_shapley_values</span><span class="p">(</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;combinatorial_exact&quot;</span><span class="p">)</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="n">df</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>We can convert the return value to a
<a class="autorefs autorefs-external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame">pandas.DataFrame</a>.
and name the column with the results as <code>value</code>. Please refer to the
documentation in <a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/shapley/#pydvl.value.shapley">shapley</a> and
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/result/#pydvl.value.result.ValuationResult">ValuationResult</a> for more information.</p>
<h3 id="monte-carlo-combinatorial-shapley">Monte Carlo Combinatorial Shapley<a class="headerlink" href="#monte-carlo-combinatorial-shapley" title="Permanent link">&para;</a></h3>
<p>Because the number of subsets <span class="arithmatex">\(S \subseteq D \setminus \{x_i\}\)</span> is
<span class="arithmatex">\(2^{ | D | - 1 }\)</span>, one typically must resort to approximations. The simplest
one is done via Monte Carlo sampling of the powerset <span class="arithmatex">\(\mathcal{P}(D)\)</span>. In pyDVL
this simple technique is called "Monte Carlo Combinatorial". The method has very
poor converge rate and others are preferred, but if desired, usage follows the
same pattern:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_shapley_values</span><span class="p">,</span> <span class="n">MaxUpdates</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_shapley_values</span><span class="p">(</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>   <span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;combinatorial_montecarlo&quot;</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="n">MaxUpdates</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="p">)</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="n">df</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;cmc&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>The DataFrames returned by most Monte Carlo methods will contain approximate
standard errors as an additional column, in this case named <code>cmc_stderr</code>.</p>
<p>Note the usage of the object <a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/stopping/#pydvl.value.stopping.MaxUpdates">MaxUpdates</a> as the
stop condition. This is an instance of a
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/stopping/#pydvl.value.stopping.StoppingCriterion">StoppingCriterion</a>. Other examples are
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/stopping/#pydvl.value.stopping.MaxTime">MaxTime</a> and
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/stopping/#pydvl.value.stopping.AbsoluteStandardError">AbsoluteStandardError</a>.</p>
<h3 id="owen-sampling">Owen sampling<a class="headerlink" href="#owen-sampling" title="Permanent link">&para;</a></h3>
<p><strong>Owen Sampling</strong> (Okhrati and Lipani, 2021)<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup> is a practical
algorithm based on the combinatorial definition. It uses a continuous extension
of the utility from <span class="arithmatex">\(\{0,1\}^n\)</span>, where a 1 in position <span class="arithmatex">\(i\)</span> means that sample
<span class="arithmatex">\(x_i\)</span> is used to train the model, to <span class="arithmatex">\([0,1]^n\)</span>. The ensuing expression for
Shapley value uses integration instead of discrete weights:</p>
<div class="arithmatex">\[
v_u(i) = \int_0^1 \mathbb{E}_{S \sim P_q(D_{\backslash \{ i \}})}
[u(S \cup {i}) - u(S)]
.\]</div>
<p>Using Owen sampling follows the same pattern as every other method for Shapley
values in pyDVL. First construct the dataset and utility, then call
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/shapley/common/#pydvl.value.shapley.common.compute_shapley_values">compute_shapley_values</a>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_shapley_values</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_shapley_values</span><span class="p">(</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>   <span class="n">u</span><span class="o">=</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;owen&quot;</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">max_q</span><span class="o">=</span><span class="mi">200</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="p">)</span>
</span></code></pre></div>
<p>There are more details on Owen sampling, and its variant <em>Antithetic Owen
Sampling</em> in the documentation for the function doing the work behind the scenes:
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/shapley/owen/#pydvl.value.shapley.owen.owen_sampling_shapley">owen_sampling_shapley</a>.</p>
<p>Note that in this case we do not pass a
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/stopping/#pydvl.value.stopping.StoppingCriterion">StoppingCriterion</a> to the function, but instead
the number of iterations and the maximum number of samples to use in the
integration.</p>
<h3 id="permutation-shapley">Permutation Shapley<a class="headerlink" href="#permutation-shapley" title="Permanent link">&para;</a></h3>
<p>An equivalent way of computing Shapley values (<code>ApproShapley</code>) appeared in
 (Castro et al., 2009)<sup id="fnref:3"><a class="footnote-ref" href="#fn:3">3</a></sup> and is the basis for the method most often
used in practice. It uses permutations over indices instead of subsets:</p>
<div class="arithmatex">\[
v_u(x_i) = \frac{1}{n!} \sum_{\sigma \in \Pi(n)}
[u(\sigma_{:i} \cup \{i\}) − u(\sigma_{:i})]
,\]</div>
<p>where <span class="arithmatex">\(\sigma_{:i}\)</span> denotes the set of indices in permutation sigma before the
position where <span class="arithmatex">\(i\)</span> appears. To approximate this sum (which has <span class="arithmatex">\(\mathcal{O}(n!)\)</span>
terms!) one uses Monte Carlo sampling of permutations, something which has
surprisingly low sample complexity. One notable difference wrt. the
combinatorial approach above is that the approximations always fulfill the
efficiency axiom of Shapley, namely <span class="arithmatex">\(\sum_{i=1}^n \hat{v}_i = u(D)\)</span> (see
 (Castro et al., 2009)<sup id="fnref2:3"><a class="footnote-ref" href="#fn:3">3</a></sup>, Proposition 3.2).</p>
<p>By adding early stopping, the result is the so-called <strong>Truncated Monte Carlo
Shapley</strong> (Ghorbani and Zou, 2019)<sup id="fnref:4"><a class="footnote-ref" href="#fn:4">4</a></sup>, which is efficient enough to be
useful in applications.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_shapley_values</span><span class="p">,</span> <span class="n">MaxUpdates</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_shapley_values</span><span class="p">(</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>   <span class="n">u</span><span class="o">=</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;truncated_montecarlo&quot;</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="n">MaxUpdates</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="exact-shapley-for-knn">Exact Shapley for KNN<a class="headerlink" href="#exact-shapley-for-knn" title="Permanent link">&para;</a></h3>
<p>It is possible to exploit the local structure of K-Nearest Neighbours to reduce
the amount of subsets to consider: because no sample besides the K closest
affects the score, most are irrelevant and it is possible to compute a value in
linear time. This method was introduced by (Jia et al., 2019)<sup id="fnref:5"><a class="footnote-ref" href="#fn:5">5</a></sup>,
and can be used in pyDVL with:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span> <span class="nn">pydvl.utils</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Utility</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_shapley_values</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">model</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="n">utility</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_shapley_values</span><span class="p">(</span><span class="n">u</span><span class="o">=</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;knn&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="group-testing">Group testing<a class="headerlink" href="#group-testing" title="Permanent link">&para;</a></h3>
<p>An alternative approach introduced in (Jia et al., 2019)<sup id="fnref2:5"><a class="footnote-ref" href="#fn:5">5</a></sup>
first approximates the differences of values with a Monte Carlo sum. With</p>
<div class="arithmatex">\[\hat{\Delta}_{i j} \approx v_i - v_j,\]</div>
<p>one then solves the following linear constraint satisfaction problem (CSP) to
infer the final values:</p>
<div class="arithmatex">\[
\begin{array}{lll}
\sum_{i = 1}^N v_i &amp; = &amp; U (D)\\
| v_i - v_j - \hat{\Delta}_{i j} | &amp; \leqslant &amp;
\frac{\varepsilon}{2 \sqrt{N}}
\end{array}
\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We have reproduced this method in pyDVL for completeness and benchmarking,
but we don't advocate its use because of the speed and memory cost. Despite
our best efforts, the number of samples required in practice for convergence
can be several orders of magnitude worse than with e.g. Truncated Monte Carlo.
Additionally, the CSP can sometimes turn out to be infeasible.</p>
</div>
<p>Usage follows the same pattern as every other Shapley method, but with the
addition of an <code>epsilon</code> parameter required for the solution of the CSP. It
should be the same value used to compute the minimum number of samples required.
This can be done with <a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/shapley/gt/#pydvl.value.shapley.gt.num_samples_eps_delta">num_samples_eps_delta</a>, but
note that the number returned will be huge! In practice, fewer samples can be
enough, but the actual number will strongly depend on the utility, in particular
its variance.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span> <span class="nn">pydvl.utils</span> <span class="kn">import</span> <span class="n">Dataset</span><span class="p">,</span> <span class="n">Utility</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_shapley_values</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">model</span> <span class="o">=</span> <span class="o">...</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="n">data</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="n">utility</span> <span class="o">=</span> <span class="n">Utility</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">score_range</span><span class="o">=</span><span class="p">(</span><span class="n">_min</span><span class="p">,</span> <span class="n">_max</span><span class="p">))</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="n">min_iterations</span> <span class="o">=</span> <span class="n">num_samples_eps_delta</span><span class="p">(</span><span class="n">epsilon</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">utility</span><span class="o">.</span><span class="n">score_range</span><span class="p">)</span>
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_shapley_values</span><span class="p">(</span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>   <span class="n">u</span><span class="o">=</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;group_testing&quot;</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="n">min_iterations</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="n">eps</span>
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a><span class="p">)</span>
</span></code></pre></div>
<h2 id="core-values">Core values<a class="headerlink" href="#core-values" title="Permanent link">&para;</a></h2>
<p>The Shapley values define a fair way to distribute payoffs amongst all
participants when they form a grand coalition. But they do not consider
the question of stability: under which conditions do all participants
form the grand coalition? Would the participants be willing to form
the grand coalition given how the payoffs are assigned,
or would some of them prefer to form smaller coalitions?</p>
<p>The Core is another approach to computing data values originating
in cooperative game theory that attempts to ensure this stability.
It is the set of feasible payoffs that cannot be improved upon
by a coalition of the participants.</p>
<p>It satisfies the following 2 properties:</p>
<ul>
<li>
<p><strong>Efficiency</strong>:
  The payoffs are distributed such that it is not possible
  to make any participant better off
  without making another one worse off.
  <span class="arithmatex">\(<span class="arithmatex">\(\sum_{x_i\in D} v_u(x_i) = u(D)\,\)</span>\)</span></p>
</li>
<li>
<p><strong>Coalitional rationality</strong>:
  The sum of payoffs to the agents in any coalition S is at
  least as large as the amount that these agents could earn by
  forming a coalition on their own.
  <span class="arithmatex">\(<span class="arithmatex">\(\sum_{x_i\in S} v_u(x_i) \geq u(S), \forall S \subset D\,\)</span>\)</span></p>
</li>
</ul>
<p>The second property states that the sum of payoffs to the agents
in any subcoalition <span class="arithmatex">\(S\)</span> is at least as large as the amount that
these agents could earn by forming a coalition on their own.</p>
<h3 id="least-core-values">Least Core values<a class="headerlink" href="#least-core-values" title="Permanent link">&para;</a></h3>
<p>Unfortunately, for many cooperative games the Core may be empty.
By relaxing the coalitional rationality property by a subsidy <span class="arithmatex">\(e \gt 0\)</span>,
we are then able to find approximate payoffs:</p>
<div class="arithmatex">\[
\sum_{x_i\in S} v_u(x_i) + e \geq u(S), \forall S \subset D, S \neq \emptyset \
,\]</div>
<p>The least core value <span class="arithmatex">\(v\)</span> of the <span class="arithmatex">\(i\)</span>-th sample in dataset <span class="arithmatex">\(D\)</span> wrt.
utility <span class="arithmatex">\(u\)</span> is computed by solving the following Linear Program:</p>
<div class="arithmatex">\[
\begin{array}{lll}
\text{minimize} &amp; e &amp; \\
\text{subject to} &amp; \sum_{x_i\in D} v_u(x_i) = u(D) &amp; \\
&amp; \sum_{x_i\in S} v_u(x_i) + e \geq u(S) &amp;, \forall S \subset D, S \neq \emptyset  \\
\end{array}
\]</div>
<h3 id="exact-least-core">Exact Least Core<a class="headerlink" href="#exact-least-core" title="Permanent link">&para;</a></h3>
<p>This first algorithm is just a verbatim implementation of the definition.
As such it returns as exact a value as the utility function allows
(see what this means in Problems of Data Values][problems-of-data-values]).</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_least_core_values</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_least_core_values</span><span class="p">(</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
</span></code></pre></div>
<h3 id="monte-carlo-least-core">Monte Carlo Least Core<a class="headerlink" href="#monte-carlo-least-core" title="Permanent link">&para;</a></h3>
<p>Because the number of subsets <span class="arithmatex">\(S \subseteq D \setminus \{x_i\}\)</span> is
<span class="arithmatex">\(2^{ | D | - 1 }\)</span>, one typically must resort to approximations.</p>
<p>The simplest approximation consists in using a fraction of all subsets for the
constraints. (Yan and Procaccia, 2021)<sup id="fnref:6"><a class="footnote-ref" href="#fn:6">6</a></sup> show that a quantity of order
<span class="arithmatex">\(\mathcal{O}((n - \log \Delta ) / \delta^2)\)</span> is enough to obtain a so-called
<span class="arithmatex">\(\delta\)</span>-<em>approximate least core</em> with high probability. I.e. the following
property holds with probability <span class="arithmatex">\(1-\Delta\)</span> over the choice of subsets:</p>
<div class="arithmatex">\[
\mathbb{P}_{S\sim D}\left[\sum_{x_i\in S} v_u(x_i) + e^{*} \geq u(S)\right]
\geq 1 - \delta,
\]</div>
<p>where <span class="arithmatex">\(e^{*}\)</span> is the optimal least core subsidy.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_least_core_values</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_least_core_values</span><span class="p">(</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>   <span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;montecarlo&quot;</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="n">n_iterations</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="p">)</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although any number is supported, it is best to choose <code>n_iterations</code> to be
at least equal to the number of data points.</p>
</div>
<p>Because computing the Least Core values requires the solution of a linear and a
quadratic problem <em>after</em> computing all the utility values, we offer the
possibility of splitting the latter from the former. This is useful when running
multiple experiments: use
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/least_core/montecarlo/#pydvl.value.least_core.montecarlo.mclc_prepare_problem">mclc_prepare_problem</a> to prepare a
list of problems to solve, then solve them in parallel with
<a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/least_core/common/#pydvl.value.least_core.common.lc_solve_problems">lc_solve_problems</a>.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kn">from</span> <span class="nn">pydvl.value.least_core</span> <span class="kn">import</span> <span class="n">mclc_prepare_problem</span><span class="p">,</span> <span class="n">lc_solve_problems</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="n">n_experiments</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="n">problems</span> <span class="o">=</span> <span class="p">[</span><span class="n">mclc_prepare_problem</span><span class="p">(</span><span class="n">utility</span><span class="p">,</span> <span class="n">n_iterations</span><span class="o">=</span><span class="n">n_iterations</span><span class="p">)</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_experiments</span><span class="p">)]</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="n">values</span> <span class="o">=</span> <span class="n">lc_solve_problems</span><span class="p">(</span><span class="n">problems</span><span class="p">)</span>
</span></code></pre></div>
<h2 id="semi-values">Semi-values<a class="headerlink" href="#semi-values" title="Permanent link">&para;</a></h2>
<p>Shapley values are a particular case of a more general concept called semi-value,
which is a generalization to different weighting schemes. A <strong>semi-value</strong> is
any valuation function with the form:</p>
<div class="arithmatex">\[
v\_\text{semi}(i) = \sum_{i=1}^n w(k)
\sum_{S \subset D\_{-i}^{(k)}} [U(S\_{+i})-U(S)],
\]</div>
<p>where the coefficients <span class="arithmatex">\(w(k)\)</span> satisfy the property:</p>
<div class="arithmatex">\[\sum_{k=1}^n w(k) = 1.\]</div>
<p>Two instances of this are <strong>Banzhaf indices</strong> (Wang and Jia, 2022)<sup id="fnref:7"><a class="footnote-ref" href="#fn:7">7</a></sup>,
and <strong>Beta Shapley</strong> (Kwon and Zou, 2022)<sup id="fnref:8"><a class="footnote-ref" href="#fn:8">8</a></sup>, with better numerical and
rank stability in certain situations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Shapley values are a particular case of semi-values and can therefore also be
computed with the methods described here. However, as of version 0.6.0, we
recommend using <a class="autorefs autorefs-internal" href="../code-reference/pydvl/value/shapley/common/#pydvl.value.shapley.common.compute_shapley_values">compute_shapley_values</a> instead,
in particular because it implements truncated Monte Carlo sampling for faster
computation.</p>
</div>
<h3 id="beta-shapley">Beta Shapley<a class="headerlink" href="#beta-shapley" title="Permanent link">&para;</a></h3>
<p>For some machine learning applications, where the utility is typically the
performance when trained on a set <span class="arithmatex">\(S \subset D\)</span>, diminishing returns are often
observed when computing the marginal utility of adding a new data point.</p>
<p>Beta Shapley is a weighting scheme that uses the Beta function to place more
weight on subsets deemed to be more informative. The weights are defined as:</p>
<div class="arithmatex">\[
w(k) := \frac{B(k+\beta, n-k+1+\alpha)}{B(\alpha, \beta)},
\]</div>
<p>where <span class="arithmatex">\(B\)</span> is the <a href="https://en.wikipedia.org/wiki/Beta_function">Beta function</a>,
and <span class="arithmatex">\(\alpha\)</span> and <span class="arithmatex">\(\beta\)</span> are parameters that control the weighting of the
subsets. Setting both to 1 recovers Shapley values, and setting <span class="arithmatex">\(\alpha = 1\)</span>, and
<span class="arithmatex">\(\beta = 16\)</span> is reported in (Kwon and Zou, 2022)<sup id="fnref2:8"><a class="footnote-ref" href="#fn:8">8</a></sup> to be a good choice for
some applications. See however the <a class="autorefs autorefs-internal" href="#banzhaf-indices">Banzhaf indices</a> section 
for an alternative choice of weights which is reported to work better.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_semivalues</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_semivalues</span><span class="p">(</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>   <span class="n">u</span><span class="o">=</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;beta_shapley&quot;</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="n">MaxUpdates</span><span class="p">(</span><span class="mi">500</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">16</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="p">)</span>
</span></code></pre></div>
<h3 id="banzhaf-indices">Banzhaf indices<a class="headerlink" href="#banzhaf-indices" title="Permanent link">&para;</a></h3>
<p>As noted below in the <a class="autorefs autorefs-internal" href="#problems-of-data-values">Problems of Data Values</a> section,
the Shapley value can be very sensitive to variance in the utility function.
For machine learning applications, where the utility is typically the performance
when trained on a set <span class="arithmatex">\(S \subset D\)</span>, this variance is often largest
for smaller subsets <span class="arithmatex">\(S\)</span>. It is therefore reasonable to try reducing
the relative contribution of these subsets with adequate weights.</p>
<p>One such choice of weights is the Banzhaf index, which is defined as the
constant:</p>
<div class="arithmatex">\[w(k) := 2^{n-1},\]</div>
<p>for all set sizes <span class="arithmatex">\(k\)</span>. The intuition for picking a constant weight is that for
any choice of weight function <span class="arithmatex">\(w\)</span>, one can always construct a utility with
higher variance where <span class="arithmatex">\(w\)</span> is greater. Therefore, in a worst-case sense, the best
one can do is to pick a constant weight.</p>
<p>The authors of (Wang and Jia, 2022)<sup id="fnref2:7"><a class="footnote-ref" href="#fn:7">7</a></sup> show that Banzhaf indices are more
robust to variance in the utility function than Shapley and Beta Shapley values.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">from</span> <span class="nn">pydvl.value</span> <span class="kn">import</span> <span class="n">compute_semivalues</span><span class="p">,</span> <span class="n">MaxUpdates</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">values</span> <span class="o">=</span> <span class="n">compute_semivalues</span><span class="p">(</span> <span class="n">u</span><span class="o">=</span><span class="n">utility</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;banzhaf&quot;</span><span class="p">,</span> <span class="n">done</span><span class="o">=</span><span class="n">MaxUpdates</span><span class="p">(</span><span class="mi">500</span><span class="p">))</span>
</span></code></pre></div>
<h2 id="problems-of-data-values">Problems of data values<a class="headerlink" href="#problems-of-data-values" title="Permanent link">&para;</a></h2>
<p>There are a number of factors that affect how useful values can be for your
project. In particular, regression can be especially tricky, but the particular
nature of every (non-trivial) ML problem can have an effect:</p>
<ul>
<li><strong>Unbounded utility</strong>: Choosing a scorer for a classifier is simple: accuracy
  or some F-score provides a bounded number with a clear interpretation. However,
  in regression problems most scores, like <span class="arithmatex">\(R^2\)</span>, are not bounded because
  regressors can be arbitrarily bad. This leads to great variability in the
  utility for low sample sizes, and hence unreliable Monte Carlo approximations
  to the values. Nevertheless, in practice it is only the ranking of samples
  that matters, and this tends to be accurate (wrt. to the true ranking) despite
  inaccurate values.</li>
</ul>
<p>pyDVL offers a dedicated <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/score/#pydvl.utils.score.compose_score">function composition</a>
  for scorer functions which can be used to squash a score.
  The following is defined in module <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/score/#pydvl.utils.score">score</a>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="kn">from</span> <span class="nn">pydvl.utils.types</span> <span class="kn">import</span> <span class="n">compose_score</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="k">def</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>  <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)))</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="n">squashed_r2</span> <span class="o">=</span> <span class="n">compose_score</span><span class="p">(</span><span class="s2">&quot;r2&quot;</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">,</span> <span class="s2">&quot;squashed r2&quot;</span><span class="p">)</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="n">squashed_variance</span> <span class="o">=</span> <span class="n">compose_score</span><span class="p">(</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a>  <span class="s2">&quot;explained_variance&quot;</span><span class="p">,</span> <span class="n">sigmoid</span><span class="p">,</span> <span class="s2">&quot;squashed explained variance&quot;</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="p">)</span>
</span></code></pre></div>
<p>These squashed scores can prove useful in regression problems, but they can
  also introduce issues in the low-value regime.</p>
<ul>
<li><strong>High variance utility</strong>: Classical applications of game theoretic value
  concepts operate with deterministic utilities, but in ML we use an evaluation
  of the model on a validation set as a proxy for the true risk. Even if the
  utility <em>is</em> bounded, if it has high variance then values will also have high
  variance, as will their Monte Carlo estimates. One workaround in pyDVL is to
  configure the caching system to allow multiple evaluations of the utility for
  every index set. A moving average is computed and returned once the standard
  error is small, see <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/config/#pydvl.utils.config.MemcachedConfig">MemcachedConfig</a>.</li>
</ul>
<p>(Wang and Jia, 2022)<sup id="fnref3:7"><a class="footnote-ref" href="#fn:7">7</a></sup> prove that by relaxing one of the Shapley axioms
  and considering the general class of semi-values, of which Shapley is an
  instance, one can prove that a choice of constant weights is the best one can
  do in a utility-agnostic setting. So-called <em>Data Banzhaf</em> is on our to-do
  list!</p>
<ul>
<li>
<p><strong>Data set size</strong>: Computing exact Shapley values is NP-hard, and Monte Carlo
  approximations can converge slowly. Massive datasets are thus impractical, at
  least with current techniques. A workaround is to group samples and investigate
  their value together. In pyDVL you can do this using
  <a class="autorefs autorefs-internal" href="../code-reference/pydvl/utils/dataset/#pydvl.utils.dataset.GroupedDataset">GroupedDataset</a>. 
  There is a fully worked-out <a href="../examples/shapley_basic_spotify">example here</a>.
  Some algorithms also provide different sampling strategies to reduce 
  the variance, but due to a no-free-lunch-type theorem,
  no single strategy can be optimal for all utilities.</p>
</li>
<li>
<p><strong>Model size</strong>: Since every evaluation of the utility entails retraining the
  whole model on a subset of the data, large models require great amounts of
  computation. But also, they will effortlessly interpolate small to medium
  datasets, leading to great variance in the evaluation of performance on the
  dedicated validation set. One mitigation for this problem is cross-validation,
  but this would incur massive computational cost. As of v.0.3.0 there are no
  facilities in pyDVL for cross-validating the utility (note that this would
  require cross-validating the whole value computation).</p>
</li>
</ul>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Wang, T., Yang, Y., Jia, R., 2022. Improving <span class="nocase">Cooperative Game Theory-based Data Valuation</span> via Data Utility Learning, in: International Conference on Learning Representations (ICLR 2022). Workshop on Socially Responsible Machine Learning. arXiv. <a href="https://doi.org/10.48550/arXiv.2107.06336">https://doi.org/10.48550/arXiv.2107.06336</a>&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p>Okhrati, R., Lipani, A., 2021. A Multilinear Sampling Algorithm to Estimate Shapley Values, in: 2020 25th International Conference on Pattern Recognition (ICPR). IEEE, pp. 7992–7999. <a href="https://doi.org/10.1109/ICPR48806.2021.9412511">https://doi.org/10.1109/ICPR48806.2021.9412511</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn:3">
<p>Castro, J., Gómez, D., Tejada, J., 2009. Polynomial calculation of the Shapley value based on sampling. Computers   &amp; Operations Research, Selected papers presented at the Tenth International Symposium on Locational Decisions (ISOLDE X) 36, 1726–1730. <a href="https://doi.org/10.1016/j.cor.2008.04.004">https://doi.org/10.1016/j.cor.2008.04.004</a>&#160;<a class="footnote-backref" href="#fnref:3" title="Jump back to footnote 3 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:3" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn:4">
<p>Ghorbani, A., Zou, J., 2019. <a href="http://proceedings.mlr.press/v97/ghorbani19c.html">Data Shapley: Equitable Valuation of Data for Machine Learning</a>, in: Proceedings of the 36th International Conference on Machine Learning, PMLR. PMLR, pp. 2242–2251.&#160;<a class="footnote-backref" href="#fnref:4" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn:5">
<p>Jia, R., Dao, D., Wang, B., Hubis, F.A., Gurel, N.M., Li, B., Zhang, C., Spanos, C., Song, D., 2019. Efficient task-specific data valuation for nearest neighbor algorithms. Proceedings of the VLDB Endowment 12, 1610–1623. <a href="https://doi.org/10.14778/3342263.3342637">https://doi.org/10.14778/3342263.3342637</a>&#160;<a class="footnote-backref" href="#fnref:5" title="Jump back to footnote 5 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:5" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn:6">
<p>Yan, T., Procaccia, A.D., 2021. If You Like Shapley Then You’ll Love the Core, in: Proceedings of the 35th AAAI Conference on Artificial Intelligence, 2021. Association for the Advancement of Artificial Intelligence, Virtual conference, pp. 5751–5759. <a href="https://doi.org/10.1609/aaai.v35i6.16721">https://doi.org/10.1609/aaai.v35i6.16721</a>&#160;<a class="footnote-backref" href="#fnref:6" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
<li id="fn:7">
<p>Wang, J.T., Jia, R., 2022. Data Banzhaf: A Robust Data Valuation Framework for Machine Learning. <a href="https://doi.org/10.48550/arXiv.2205.15466">https://doi.org/10.48550/arXiv.2205.15466</a>&#160;<a class="footnote-backref" href="#fnref:7" title="Jump back to footnote 7 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:7" title="Jump back to footnote 7 in the text">&#8617;</a><a class="footnote-backref" href="#fnref3:7" title="Jump back to footnote 7 in the text">&#8617;</a></p>
</li>
<li id="fn:8">
<p>Kwon, Y., Zou, J., 2022. <a href="http://arxiv.org/abs/2110.14049">Beta Shapley: A Unified and <span class="nocase">Noise-reduced Data Valuation Framework</span> for Machine Learning</a>, in: Proceedings of the 25th International Conference on Artificial Intelligence and Statistics (AISTATS) 2022,. PMLR, Valencia, Spain.&#160;<a class="footnote-backref" href="#fnref:8" title="Jump back to footnote 8 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2:8" title="Jump back to footnote 8 in the text">&#8617;</a></p>
</li>
</ol>
</div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-08-10</span>
      
        <br>
        Created:
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2022-10-11</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../20-install/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Installing pyDVL" rel="prev">
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Installing pyDVL
              </div>
            </div>
          </a>
        
        
          
          <a href="../40-influence/" class="md-footer__link md-footer__link--next" aria-label="Next: Computing Influence Values" rel="next">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Computing Influence Values
              </div>
            </div>
            <div class="md-footer__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; AppliedAI Institute gGmbH
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/appliedAI-Initiative/pyDVL" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/pyDVL/" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6zM286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3zM167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4zm-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "search.highlight", "toc.follow", "navigation.top", "navigation.instant", "navigation.sections", "navigation.path", "navigation.tracking", "navigation.footer", "content.code.copy", "content.code.annotate"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../javascripts/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>